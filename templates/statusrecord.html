{% extends "base.html" %}

{% block content %}
<div class="container mt-5">
    <h2>Status Report</h2>
    <form method="POST" class="mb-3">
        {% csrf_token %}
        <div class="row">
            <div class="col-md-4">
                <label for="status_date" class="form-label">Select Date:</label>
                <input type="date" class="form-control" id="status_date" name="status_date" value="{{ status_date|date:'Y-m-d' }}">
            </div>
            <div class="col-md-2 d-flex align-items-end">
                <button type="submit" class="btn btn-primary">Go</button>
            </div>
        </div>
    </form>
    <div class="mb-3">
        <button id="exportStatusExcel" class="btn btn-success">Export to Excel</button>
    </div>
    <table class="table table-striped" id="statusReportTable">
        <thead>
            <tr>
                <th>Username</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            {% for username, status in status_report.items %}
            <tr>
                <td>{{ username }}</td>
                <td>{{ status }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
    // Export to Excel for Status Report
    document.getElementById('exportStatusExcel').addEventListener('click', function() {
        var wb = XLSX.utils.table_to_book(document.getElementById('statusReportTable'), {sheet:"Status Report"});
        XLSX.writeFile(wb, 'Status_Report.xlsx');
    });
</script>
{% endblock %}
